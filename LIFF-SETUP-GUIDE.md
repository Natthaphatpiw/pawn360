# üîß LIFF Configuration Guide

## ‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏¥‡∏î

1. **Application error** - ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å‡πÉ‡∏ä‡πâ URL ‡∏ú‡∏¥‡∏î
2. **Internal server error** - ‡πÄ‡∏Å‡∏¥‡∏î‡∏à‡∏≤‡∏Å LIFF Endpoint URL ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î

---

## ‚úÖ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç: ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LIFF Endpoint URL

‡πÑ‡∏õ‡∏ó‡∏µ‡πà **LINE Developers Console** ‚Üí **LIFF tab** ‚Üí ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏ï‡πà‡∏•‡∏∞ LIFF:

### 1. ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å Pawn360
- **LIFF ID:** `2008216710-BEZ5XNyd`
- **Endpoint URL:** `https://pawn360.vercel.app/register`
- ‚ùå **‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ:** `https://pawn360.vercel.app` (‡∏´‡∏ô‡πâ‡∏≤ root)

### 2. ‡∏à‡∏≥‡∏ô‡∏≥
- **LIFF ID:** `2008216710-54P86MRY`
- **Endpoint URL:** `https://pawn360.vercel.app/pawn/new`
- ‚ùå **‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ:** `https://pawn360.vercel.app`

### 3. ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤
- **LIFF ID:** `2008216710-WJXR6xOM`
- **Endpoint URL:** `https://pawn360.vercel.app/contracts`
- ‚ùå **‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ:** `https://pawn360.vercel.app`

### 4. ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡πâ‡∏≤‡∏ô‡∏Ñ‡πâ‡∏≤‡∏£‡∏±‡∏ö‡∏à‡∏≥‡∏ô‡∏≥
- **LIFF ID:** `2008216710-de1ovYZL`
- **Endpoint URL:** `https://pawn360.vercel.app/store/verify-pawn`
- ‚ùå **‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ:** `https://pawn360.vercel.app`

---

## üì± Rich Menu Configuration

### ‚úÖ URLs ‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (‡πÉ‡∏ä‡πâ LIFF URL ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î)

| ‡∏õ‡∏∏‡πà‡∏° | Action Type | URL |
|------|-------------|-----|
| ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏±‡∏ç‡∏ç‡∏≤ | Link | `https://liff.line.me/2008216710-WJXR6xOM/contracts` |
| ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô | Link | `https://liff.line.me/2008216710-BEZ5XNyd/register` |
| ‡∏à‡∏≥‡∏ô‡∏≥ | Link | `https://liff.line.me/2008216710-54P86MRY/pawn/new` |
| ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏±‡∏ç‡∏ç‡∏≤ | Link | `https://liff.line.me/2008216710-WJXR6xOM/contracts` |
| QR Code | No action | - |
| ‡πÇ‡∏ó‡∏£ | Text | `Phone: 062-6092941` |

### ‚ùå URLs ‡∏ó‡∏µ‡πà‡∏ú‡∏¥‡∏î (‡∏≠‡∏¢‡πà‡∏≤‡πÉ‡∏ä‡πâ)

| ‚ùå ‡∏ú‡∏¥‡∏î | ‚úÖ ‡∏ñ‡∏π‡∏Å |
|--------|---------|
| `https://pawn360.vercel.app/register` | `https://liff.line.me/2008216710-BEZ5XNyd/register` |
| `https://pawn360.vercel.app/pawn/new` | `https://liff.line.me/2008216710-54P86MRY/pawn/new` |
| `https://pawn360.vercel.app/contracts` | `https://liff.line.me/2008216710-WJXR6xOM/contracts` |

---

## üîç ‡∏ó‡∏≥‡πÑ‡∏°‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ LIFF URL?

### LIFF URL Format:
```
https://liff.line.me/{LIFF_ID}/{path}
```

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏•‡∏¥‡∏Å LIFF URL:
1. LINE app ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î in-app browser
2. Initialize LIFF SDK ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
3. ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏ô‡πâ‡∏≤ `https://pawn360.vercel.app/{path}` ‡∏ú‡πà‡∏≤‡∏ô LIFF context
4. ‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• LINE profile (userId, displayName, etc.)

### Direct URL (‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô LIFF):
```
https://pawn360.vercel.app/pawn/new  ‚ùå Error!
```

‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏õ‡∏¥‡∏î Direct URL:
1. ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô browser ‡∏õ‡∏Å‡∏ï‡∏¥
2. ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ LIFF SDK initialization
3. ‚ùå ‡πÑ‡∏°‡πà‡∏°‡∏µ LINE profile
4. ‚ùå ‡πÄ‡∏Å‡∏¥‡∏î error: "LINE profile not found"

---

## üéØ ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á LIFF Endpoint URL

### ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:

**LIFF URL:**
```
https://liff.line.me/2008216710-54P86MRY/pawn/new
```

**LINE ‡∏à‡∏∞:**
1. ‡πÄ‡∏ä‡πá‡∏Ñ‡∏ß‡πà‡∏≤ LIFF ID `2008216710-54P86MRY` ‡∏°‡∏µ Endpoint URL = `https://pawn360.vercel.app/pawn/new`
2. Initialize LIFF SDK
3. Redirect ‡πÑ‡∏õ `https://pawn360.vercel.app/pawn/new`
4. Pass LIFF context (userId, etc.)

---

## ‚öôÔ∏è Vercel Environment Variables

‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß:

```env
# Backend LIFF IDs
LIFF_ID_REGISTER=2008216710-BEZ5XNyd
LIFF_ID_PAWN=2008216710-54P86MRY
LIFF_ID_CONTRACTS=2008216710-WJXR6xOM
LIFF_ID_STORE=2008216710-de1ovYZL

# Frontend LIFF IDs (NEXT_PUBLIC_*)
NEXT_PUBLIC_LIFF_ID_REGISTER=2008216710-BEZ5XNyd
NEXT_PUBLIC_LIFF_ID_PAWN=2008216710-54P86MRY
NEXT_PUBLIC_LIFF_ID_CONTRACTS=2008216710-WJXR6xOM
NEXT_PUBLIC_LIFF_ID_STORE=2008216710-de1ovYZL

# LINE Configuration
LINE_CHANNEL_ACCESS_TOKEN=UeHWta6KPHXAUZCZFxJsgpVpF04yulZP+z3w7F/PO4Uzd2U0Rxl1VhuC4wSFIcPGZGNeYXkr6xSq1Ziz36RIgaM0O8xSk8+gJcYlmPBa1ONycwtKnkXk3UTohvHUgTvvA58l/1G9SiPerwDSZs3rewdB04t89/1O/w1cDnyilFU=
LINE_CHANNEL_SECRET=9469acf57221ec18b48b04f82096cb2b

# MongoDB
MONGODB_URI=mongodb+srv://natthapiw_db_user:afOJe2MrgMDsmm6k@cluster0.skadipr.mongodb.net/?retryWrites=true&w=majority&appName=Cluster0
MONGODB_DB=pawn

# Rich Menu
RICH_MENU_ID_NEW_USER=richmenu-cd730e69b15a075c3bbe729a1c88f76e
RICH_MENU_ID_MEMBER=richmenu-d58a81249cf5f525da5ba9594cd8e111
```

---

## üìã Checklist

- [ ] ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LIFF Endpoint URL ‡∏ó‡∏±‡πâ‡∏á 4 LIFF ‡πÉ‡∏ô LINE Developers Console
- [ ] ‡πÅ‡∏Å‡πâ Rich Menu URLs ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô LIFF URL ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
- [ ] ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Environment Variables ‡πÉ‡∏ô Vercel
- [ ] Redeploy Vercel (‡∏ñ‡πâ‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏° env vars ‡πÉ‡∏´‡∏°‡πà)
- [ ] ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Rich Menu ‡∏ó‡∏∏‡∏Å‡∏õ‡∏∏‡πà‡∏°

---

## üêõ Troubleshooting

### Error: "Application error: a client-side exception has occurred"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** ‡πÉ‡∏ä‡πâ Direct URL ‡πÅ‡∏ó‡∏ô LIFF URL ‡πÉ‡∏ô Rich Menu
**‡πÅ‡∏Å‡πâ:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô `https://liff.line.me/{LIFF_ID}/{path}`

### Error: "Internal server error"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** LIFF Endpoint URL ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ú‡∏¥‡∏î
**‡πÅ‡∏Å‡πâ:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Endpoint URL ‡πÉ‡∏ô LINE Developers Console

### Error: "LINE profile not found"
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** LIFF ‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ initialize
**‡πÅ‡∏Å‡πâ:** ‡πÉ‡∏ä‡πâ LIFF URL ‡πÅ‡∏ó‡∏ô Direct URL

### ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á home page ‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
**‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏:** LIFF Endpoint URL = `https://pawn360.vercel.app` (root)
**‡πÅ‡∏Å‡πâ:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô specific path ‡πÄ‡∏ä‡πà‡∏ô `https://pawn360.vercel.app/contracts`
